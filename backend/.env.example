# ==============================================================================
# SYNAPLAN ENVIRONMENT CONFIGURATION
# ==============================================================================
# Copy to .env (git-ignored) and adjust values as needed.
# Sections match the Admin → System Config UI tabs.
# ==============================================================================


# ==============================================================================
# 1. APPLICATION CORE
# ==============================================================================
# Essential application settings and URLs
# ==============================================================================

# APP_ENV is set via docker-compose environment, not here
APP_SECRET=changeme_in_production

# Log format: json (production) or text (development)
LOG_FORMAT=text

# Secret key for HMAC-signing access tokens (change in production!)
TOKEN_SECRET=changeme_use_strong_secret_in_production

# Lock component for background processes (prevents overlapping cron jobs)
# Options: flock (default), redis://localhost, semaphore
LOCK_DSN=flock

# Public URLs
FRONTEND_URL=http://localhost:5173
SYNAPLAN_URL=http://localhost:8000
APP_URL=http://localhost:8000

# Misc
AUTO_DOWNLOAD_MODELS=false


# ==============================================================================
# 2. AI SERVICES
# ==============================================================================
# Configure AI providers for chat, embeddings, and content generation
# ==============================================================================

# --- Local AI (Ollama) ---
# Docker: http://ollama:11434 | Local: http://localhost:11434
OLLAMA_BASE_URL=http://ollama:11434

# --- Cloud AI Providers (optional - Ollama works without these) ---
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GROQ_API_KEY=
GOOGLE_GEMINI_API_KEY=
HUGGINGFACE_API_KEY=

# --- TheHive AI (Image Generation) ---
# Get API key: https://thehive.ai/
# Models: Flux Schnell, Flux Schnell Enhanced, SDXL, SDXL Enhanced, Emoji
THEHIVE_API_KEY=

# --- Self-Hosted AI (optional) ---
# NVIDIA Triton gRPC endpoint (port 8001 default)
# Example: triton-server:8001 (Docker) or localhost:8001 (local)
TRITON_SERVER_URL=

# --- Text-to-Speech (optional) ---
# Piper TTS (self-hosted, free, multi-language)
# Run via synaplan-tts repo: docker compose up -d (binds to port 10200)
# Docker: http://host.docker.internal:10200 | Local: http://localhost:10200
# Leave empty to use hardcoded default (http://host.docker.internal:10200)
SYNAPLAN_TTS_URL=

# ElevenLabs (cloud TTS)
ELEVENLABS_API_KEY=


# ==============================================================================
# 3. EMAIL CONFIGURATION
# ==============================================================================
# Outbound email for notifications, password resets, and signups
# ==============================================================================

# SMTP connection string
# Dev: null://null (no emails) or smtp://mailhog:1025 (test UI at localhost:8025)
# Prod: smtp://user:pass@smtp.example.com:587
MAILER_DSN=null://null

# Sender information (optional - uses system defaults if empty)
APP_SENDER_EMAIL=
APP_SENDER_NAME=Synaplan


# ==============================================================================
# 4. AUTHENTICATION & SECURITY
# ==============================================================================
# OAuth providers, SSO, and security features
# ==============================================================================

# --- Google reCAPTCHA v3 ---
# Get keys: https://www.google.com/recaptcha/admin
RECAPTCHA_ENABLED=false
RECAPTCHA_SITE_KEY=your_site_key_here
RECAPTCHA_SECRET_KEY=your_secret_key_here
RECAPTCHA_MIN_SCORE=0.5

# --- Google OAuth 2.0 ---
# Get credentials: https://console.cloud.google.com/apis/credentials
# Callback URL: {SYNAPLAN_URL}/api/v1/auth/google/callback
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CLOUD_PROJECT_ID=

# --- GitHub OAuth 2.0 ---
# Get credentials: https://github.com/settings/developers
# Callback URL: {SYNAPLAN_URL}/api/v1/auth/github/callback
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# --- OIDC (Enterprise SSO) ---
OIDC_DISCOVERY_URL=
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=
OIDC_AUTO_REDIRECT=false


# ==============================================================================
# 5. INBOUND CHANNELS
# ==============================================================================
# External channels for interacting with the AI platform
# ==============================================================================

# --- WhatsApp Business API ---
WHATSAPP_ENABLED=false
WHATSAPP_ACCESS_TOKEN=
WHATSAPP_WEBHOOK_VERIFY_TOKEN=

# --- Smart Mail (Gmail IMAP) ---
# For AI-powered email responses via smart@yourdomain.com
# Requires: 2-Step Verification enabled on Google account
# Generate App Password: https://myaccount.google.com/apppasswords
# See: backend/docs/GMAIL_APP_PASSWORD_SETUP.md
GMAIL_USERNAME=
GMAIL_PASSWORD=


# ==============================================================================
# 6. DOCUMENT PROCESSING
# ==============================================================================
# Text extraction, OCR, transcription, and web search
# ==============================================================================

# --- Apache Tika (Text Extraction) ---
TIKA_BASE_URL=http://tika:9998
TIKA_TIMEOUT_MS=30000
TIKA_RETRIES=2
TIKA_RETRY_BACKOFF_MS=1000
TIKA_HTTP_USER=
TIKA_HTTP_PASS=
TIKA_MIN_LENGTH=10
TIKA_MIN_ENTROPY=3.0

# --- PDF Rasterizer (OCR for scanned PDFs) ---
RASTERIZE_DPI=150
RASTERIZE_PAGE_CAP=10
RASTERIZE_TIMEOUT_MS=30000

# --- Whisper (Audio Transcription) ---
WHISPER_ENABLED=true
WHISPER_DEFAULT_MODEL=base
WHISPER_BINARY=/usr/local/bin/whisper
WHISPER_MODELS_PATH=/var/www/backend/var/whisper
FFMPEG_BINARY=/usr/bin/ffmpeg

# --- Brave Web Search ---
# Get API key: https://api.search.brave.com/
BRAVE_SEARCH_ENABLED=false
BRAVE_SEARCH_API_KEY=
BRAVE_SEARCH_API_URL=https://api.search.brave.com/res/v1
BRAVE_SEARCH_COUNT=10
BRAVE_SEARCH_COUNTRY=us
BRAVE_SEARCH_SEARCH_LANG=en


# ==============================================================================
# 7. VECTOR DATABASE
# ==============================================================================
# Qdrant for semantic search and RAG
# ==============================================================================

# Qdrant Microservice (Rust wrapper)
# Docker: http://qdrant-service:8090 | Local: http://localhost:8090
QDRANT_SERVICE_URL=http://qdrant-service:8090

# API Key (optional in dev, required in prod)
# Generate: openssl rand -hex 32
QDRANT_SERVICE_API_KEY=changeme-in-production


# ==============================================================================
# 8. PAYMENTS & BILLING (manual edit only)
# ==============================================================================
# Stripe integration - not editable via web UI for security
# ==============================================================================

# Get keys: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Price IDs from Stripe Dashboard (Products → Prices)
STRIPE_PRICE_PRO=price_pro_monthly
STRIPE_PRICE_TEAM=price_team_monthly
STRIPE_PRICE_BUSINESS=price_business_monthly

# Payment methods (comma-separated)
# Available: card, link, sepa_debit, klarna, bancontact, eps, giropay, ideal, p24, sofort
STRIPE_PAYMENT_METHODS=card,link,klarna


# ==============================================================================
# 9. DATABASE (manual edit only)
# ==============================================================================
# MySQL/MariaDB connection - not editable via web UI for security
# ==============================================================================

# Docker Compose credentials
MYSQL_DATABASE=synaplan
MYSQL_USER=synaplan_user
MYSQL_PASSWORD=synaplan_password
MYSQL_ROOT_PASSWORD=root_password

# Doctrine URLs (read/write replica pattern)
# Format: mysql://user:password@host:port/database?serverVersion=X.X&charset=utf8mb4
DATABASE_WRITE_URL=mysql://synaplan_user:synaplan_password@db:3306/synaplan?serverVersion=11.8&charset=utf8mb4
DATABASE_READ_URL=mysql://synaplan_user:synaplan_password@db:3306/synaplan?serverVersion=11.8&charset=utf8mb4

# =============================================================================
# --- Discord Webhook (optional) ---
# Send notifications to Discord when WhatsApp messages are processed
# Get webhook URL from Discord: Server Settings > Integrations > Webhooks
# =============================================================================
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/1234567890/abcdefghijklmnopqrstuvwxyz
